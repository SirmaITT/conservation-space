<?xml version="1.0"?>

<definition id="documentAllActions" type="document" isAbstract="true" parentId="commonDocument">
	
	<!-- Document which has all document actions -->
	
     	<fields>
			<field name="status"   type="an..35" codelist="CL8" label="status.label" mandatory="false" displayType="readonly" previewEmpty="false" dmsType="emf:status" uri="emf:status" />
			<field name="emf:revisionType" type="URI" label="document.revisionType" mandatory="false" displayType="system" previewEmpty="false" uri="emf:revisionType" />
			<field name="emf:publishedOn" type="datetime" label="document.publishedOn" mandatory="false" displayType="system" previewEmpty="false" uri="emf:publishedOn" />
			<field name="emf:publishedBy" type="uri" label="document.publishedBy" mandatory="false" displayType="system" previewEmpty="false" uri="emf:publishedBy">
			  	<control id="PICKER">
	    			<control-param id="range" name="range">emf:User</control-param>
	    		</control>
			</field>
		</fields>
		<transitions>
			<transition id="approve" label="approve.label" eventId="approve" purpose="transition" immediate="true" tooltip="approve.tooltip" />
			<transition id="reject" label="reject.label" eventId="reject" purpose="transition" immediate="true" tooltip="reject.tooltip" />
			<transition id="clone" label="clone.label" eventId="clone" purpose="clone" tooltip="clone.tooltip" />
			<transition id="publish" label="publish.label" eventId="publish" purpose="publish" tooltip="publish.tooltip"/>
			<transition id="publishAsPdf" label="publishAsPdf.label" eventId="publishAsPdf" purpose="publishAsPdf" tooltip="publishAsPdf.tooltip"/>
		</transitions>
		<stateTransitions>
			<stateTransition from="INIT" transition="create" to="DRAFT"/>
			<stateTransition from="INIT" transition="clone" to="DRAFT"/>
			
			<stateTransition from="DRAFT" transition="download" to="DRAFT"/>
			<stateTransition from="DRAFT" transition="editDetails" to="DRAFT"/>
			<stateTransition from="DRAFT" transition="uploadNewVersion" to="DRAFT"/>
			<stateTransition from="DRAFT" transition="saveAsTemplate" to="DRAFT"/>			
			<stateTransition from="DRAFT" transition="delete" to="DRAFT"/>
			<stateTransition from="DRAFT" transition="approve" to="APPROVED"/>
			<stateTransition from="DRAFT" transition="reject" to="REJECTED"/>
			<stateTransition from="DRAFT" transition="move" to="DRAFT"/>
			<stateTransition from="DRAFT" transition="lock" to="DRAFT"/>
			<stateTransition from="DRAFT" transition="unlock" to="DRAFT"/>			
			<stateTransition from="DRAFT" transition="managePermissions" to="DRAFT" />
			<stateTransition from="DRAFT" transition="addThumbnail" to="DRAFT" />
			<stateTransition from="DRAFT" transition="publish" to="APPROVED">
				<condition renderAs="PROPERTY" id="emf:revisionType">emf:revision</condition>
				<condition renderAs="PROPERTY" id="emf:revisionType">emf:latestRevision</condition>
			</stateTransition>
			<stateTransition from="DRAFT" transition="publish" to="DRAFT"/>
			<stateTransition from="DRAFT" transition="publishAsPdf" to="APPROVED">
				<condition renderAs="PROPERTY" id="emf:revisionType">emf:revision</condition>
				<condition renderAs="PROPERTY" id="emf:revisionType">emf:latestRevision</condition>
			</stateTransition>
			<stateTransition from="DRAFT" transition="publishAsPdf" to="DRAFT"/>
			<stateTransition from="DRAFT" transition="print" to="DRAFT"/>
			<stateTransition from="DRAFT" transition="printTab" to="DRAFT"/>
			<stateTransition from="DRAFT" transition="exportTabPDF" to="DRAFT"/>
			<stateTransition from="DRAFT" transition="exportPDF" to="DRAFT"/>
			<stateTransition from="DRAFT" transition="exportWord" to="DRAFT" />
			<stateTransition from="DRAFT" transition="exportTabWord" to="DRAFT" />
			<stateTransition from="DRAFT" transition="clone" to="DRAFT" />
			<stateTransition from="DRAFT" transition="createInContext" to="DRAFT"/>
			<stateTransition from="DRAFT" transition="revertVersion" to="DRAFT" />
			
			<stateTransition from="APPROVED" transition="download" to="APPROVED"/>
			<stateTransition from="APPROVED" transition="saveAsTemplate" to="APPROVED"/>
				
			<stateTransition from="APPROVED" transition="managePermissions" to="APPROVED" />
			<stateTransition from="APPROVED" transition="publish" to="APPROVED">
				<condition renderAs="PROPERTY" id="emf:revisionType">emf:revision</condition>
				<condition renderAs="PROPERTY" id="emf:revisionType">emf:latestRevision</condition>
			</stateTransition>
			<stateTransition from="APPROVED" transition="publish" to="DRAFT"/>				
			<stateTransition from="APPROVED" transition="publishAsPdf" to="APPROVED">
				<condition renderAs="PROPERTY" id="emf:revisionType">emf:revision</condition>
				<condition renderAs="PROPERTY" id="emf:revisionType">emf:latestRevision</condition>
			</stateTransition>
			<stateTransition from="APPROVED" transition="publishAsPdf" to="DRAFT"/>		
			<stateTransition from="APPROVED" transition="print" to="APPROVED"/>
			<stateTransition from="APPROVED" transition="printTab" to="APPROVED"/>
			<stateTransition from="APPROVED" transition="exportTabPDF" to="APPROVED"/>				
			<stateTransition from="APPROVED" transition="exportPDF" to="APPROVED"/>
			<stateTransition from="APPROVED" transition="exportWord" to="APPROVED" />
			<stateTransition from="APPROVED" transition="exportTabWord" to="APPROVED" />
			<stateTransition from="APPROVED" transition="clone" to="APPROVED" />
						
			<stateTransition from="REJECTED" transition="download" to="REJECTED"/>
			<stateTransition from="REJECTED" transition="saveAsTemplate" to="REJECTED"/>			
			<stateTransition from="REJECTED" transition="managePermissions" to="REJECTED" />
			<stateTransition from="REJECTED" transition="publish" to="REJECTED">
				<condition renderAs="PROPERTY" id="emf:revisionType">emf:revision</condition>
				<condition renderAs="PROPERTY" id="emf:revisionType">emf:latestRevision</condition>
			</stateTransition>
			<stateTransition from="REJECTED" transition="publish" to="DRAFT"/>
			<stateTransition from="REJECTED" transition="publishAsPdf" to="REJECTED">
				<condition renderAs="PROPERTY" id="emf:revisionType">emf:revision</condition>
				<condition renderAs="PROPERTY" id="emf:revisionType">emf:latestRevision</condition>
			</stateTransition>
			<stateTransition from="REJECTED" transition="publishAsPdf" to="DRAFT"/>
			<stateTransition from="REJECTED" transition="print" to="REJECTED" />
			<stateTransition from="REJECTED" transition="printTab" to="REJECTED" />
			<stateTransition from="REJECTED" transition="exportTabPDF" to="REJECTED" />
			<stateTransition from="REJECTED" transition="exportPDF" to="REJECTED" />
			<stateTransition from="REJECTED" transition="exportWord" to="REJECTED" />
			<stateTransition from="REJECTED" transition="exportTabWord" to="REJECTED" />
			<stateTransition from="REJECTED" transition="clone" to="REJECTED" />

			<stateTransition from="OBSOLETE" transition="download" to="OBSOLETE"/>
			<stateTransition from="OBSOLETE" transition="saveAsTemplate" to="OBSOLETE"/>
			<stateTransition from="OBSOLETE" transition="print" to="OBSOLETE"/>
			<stateTransition from="OBSOLETE" transition="printTab" to="OBSOLETE"/>
			<stateTransition from="OBSOLETE" transition="exportTabPDF" to="OBSOLETE"/>				
			<stateTransition from="OBSOLETE" transition="exportPDF" to="OBSOLETE"/>
			<stateTransition from="OBSOLETE" transition="exportWord" to="OBSOLETE" />
			<stateTransition from="OBSOLETE" transition="exportTabWord" to="OBSOLETE" />
			<stateTransition from="OBSOLETE" transition="managePermissions" to="OBSOLETE" />
			
			<stateTransition from="*" transition="delete" to="DELETED" />
			<stateTransition from="*" transition="obsolete" to="OBSOLETE" />
		</stateTransitions>
</definition>