@import "../../../style/reusables";

@mixin set-icons-size($size) {
  .header-icon {
    img {
      object-fit: contain;
      min-width: $size;
      max-width: $size;
    }
  }
}

@mixin icons-size($size) {
  #{'&.icon-'+ $size} {
    @include set-icons-size($size+px);
  }
}

.datatable-widget {

  // prevent scroll bar to be placed at the begining of the table when radiobutton or checkbox is clicked
  label input {
    display: none;
  }

  // This fix horizontall scrollbar issue under Safari and make it visible
  ::-webkit-scrollbar {
    appearance: none;
    width: 2px;
  }
  ::-webkit-scrollbar-thumb {
    background-color: $table-border-color;
  }

  .panel-body {
    padding: 0;

    > div {
      width: 100%;
      overflow-x: auto;
    }

    .table-toolbar:empty,
    .table-footer:empty {
      display: none;
    }

    .table-toolbar {
      width: 100%;
      border-bottom: 1px solid $table-border-color;
      background-color: $toolbar-background-color;

      .item {
        padding: 3px 12px;
      }
    }

    .table-header {
      display: flex;
      flex-wrap: nowrap;
      background-color: $toolbar-background-color;
      border-bottom: 2px solid $table-border-color;

      > .header-cell {
        display: flex;
        flex-grow: 1;
        min-width: $table-column-min-width;
        border-right: 1px solid $table-border-color;
        background-color: $toolbar-background-color;

        .filter {
          padding: 3px 12px;
          border-bottom: 1px solid $table-border-color;
        }

        .title-cell {
          background-color: $toolbar-background-color;
          width: 100%;

          a {
            /* for column title and caret proper visualization */
            display: flex;
            justify-content: space-between;
            padding: 10px 12px;
            color: $default-font-color;
            @include media-font-size();
            font-weight: bold;
            /* split some too long unbreakable titles and keep proper cell formatting */
            word-break: break-word;
          }

          a:hover, a:focus {
            text-decoration: none;
          }
        }

        &.dragged {
          position: absolute;
          top: 0;
          left: 0;
          opacity: 0.5;
          z-index: 2000;
        }

        .sort-order {
          padding-right: 5px;
        }
      }

      > div:last-child {
        border-right: none;
      }

      .placeholder {
        position: relative;
        margin: 0;
        padding: 0;
        border: none;

        &:before {
          position: absolute;
          top: -5px;
          left: -5px;
          width: 0;
          height: 0;
          content: "";
          border: 5px solid transparent;
          border-left-color: #337ab7;
          border-right: none;
        }
      }
    }

    .table-body {
      .form-wrapper {
        //will be needed for future tooltip styling.
        .form-field:not(.preview-field):not(.print-field) {
          //remove inherited styling from form-wrapper.scss which breaks DTW styling.
          margin: 0;
          .input-group {
            width: 100%;
            right: 0;
          }

          .instance-box .preview {
            right: 0;
          }
        }

        // too long titles overflowed outside of table cell.
        .instance-header-wrapper .instance-data:last-child {
          word-break: break-all;
          .badge {
            display: inline-block;
          }
        }

        .object-control-wrapper .instance-box {
          @include word-wrap();
        }

        //fixes for CMF-21227 where object labels go out of its container.
        .object-control-wrapper .instance-box-header .instance-data span:not(.header-icon) {
          //instance headers in firefox don't break correctly and move out of cell.
          @include firefox() {
            white-space: pre-wrap;
            word-break: break-all;
            overflow: hidden;
          }

          @include edge() {
            white-space: pre-wrap;
            word-break: break-all;
          }

          @include internet-explorer-11() {
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow: hidden;
          }
        }

        .object-control-wrapper .instance-box-header .instance-data .badge {
          display: inline-flex;
        }

        .grid-on > div {
          border-right: 1px solid $table-border-color;
          border-bottom: 1px solid $table-border-color;
        }

        .grid-off > div {
          border-right: none;
          border-bottom: none;
        }

        .grid-vertical > div {
          border-right: 1px solid $table-border-color;
          border-bottom: none;
        }

        .grid-horizontal > div {
          border-right: none;
          border-bottom: 1px solid $table-border-color;
        }

        .input-datetime-wrapper, .codelist-wrapper {
          .preview-field {
            left: 0;
            width: 100%;
          }
        }
      }

      .form-wrapper > div .form-group {
        min-width: $table-column-min-width;
        flex-basis: unset;
      }

      .form-wrapper > div .form-group:last-child {
        border-right: none;
      }

      form:last-child .form-group {
        border-bottom: 2px solid $table-border-color;
      }

      .instance-header-wrapper {
        background-color: #fff;
        //IE10-11 hack to fix CMF-19560
        @include internet-explorer-11() {
          padding: 0.2px;
        }

        > span {
          width: 100%;
        }

        .btn-group {
          position: inherit;
          padding-right: 8px;

          .dropdown-menu {
            right: auto;

            .loading {
              // for more accurate menu positioning
              min-width: 200px;
            }
          }
        }
      }

      .instance-header {
        .instance-icon {
          img {
            margin-top: -5px;
          }
        }
        .instance-data {
          vertical-align: 0;

          @include icons-size(16);
          @include icons-size(64);

          .lock-label {
            padding-right: 0.5em;
          }
        }

        .label {
          white-space: normal;
        }
      }

      .form-control {
        @include media-font-size();
      }

      .has-error {
        position: relative;

        &:after {
          content: '';
          display: block;
          position: absolute;
          top: 0;
          right: 0;
          border-top: 6px solid red;
          border-left: 6px solid white;
          width: 0;
        }

        .form-control {
          border: 1px solid #c2c2c2;
        }

        /* remove red border around datatime field and red color in background */
        .datetime-field {
          border: 1px solid $table-border-color;
        }
        .datetime-picker .input-group-addon {
          border: 1px solid $table-border-color;
          background-color: #eee;
        }

        /* remove red border around dropdowns */
        .select2-container .select2-selection {
          border-color: $table-border-color;

          .select2-selection__arrow,
          &:hover .select2-selection__arrow {
            border-left-color: $table-border-color;
          }

          .select2-selection__arrow {
            border: 1px solid $table-border-color;
            background-color: #eee;
            transition: background-color 0.3s ease 0s;
          }
        }
      }
    }

    .table-footer {
      text-align: center;
    }
  }

  .tooltip {
    position: fixed;
    border: 0 !important;
  }

  .tooltip-inner {
    max-width: 200px;
    padding: 3px 8px;
    color: $tooltip-color;
    font-size: $tooltip-font-size;
    text-align: center;
    text-decoration: none;
    background-color: $tooltip-background-color;
    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    border-radius: 4px;
    left: 0;
  }

  .tooltip-arrow {
    border-top-color: $tooltip-arrow-color !important;
  }

  //so far there is no styling decision for DTW,but it must have this class;
  .datatable-tooltip {
    display: none !important;
  }

  .ui-resizable-handle {
    margin-right: 5px;
  }
}
