<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Sirma Platform : Upload Codelists and Code Values</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Sirma Platform : Upload Codelists and Code Values
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div id="main-content" class="wiki-content group">
                    <p>Only users with administrator permissions may load codelists and code values from an external file in MS Excel format (.xls).</p><ul><li>The administrator selects the option<strong> Upload </strong>from the menu in the Codelist management panel.</li></ul><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="148" width="500" src="attachments/40044697/40044712.png" data-image-src="attachments/40044697/40044712.png" data-unresolved-comment-count="0" data-linked-resource-id="40044712" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Upload 1.png" data-base-url="https://ittruse.ittbg.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="40044697" data-linked-resource-container-version="10"></img></span></p><ul><li>The system opens the screen for selecting new codelist file for upload. The user clicks<strong> &quot;Browse&quot;</strong>.</li></ul><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="317" width="412" src="attachments/40044697/40044715.png" data-image-src="attachments/40044697/40044715.png" data-unresolved-comment-count="0" data-linked-resource-id="40044715" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Upload 2.png" data-base-url="https://ittruse.ittbg.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="40044697" data-linked-resource-container-version="10"></img></span></p><ul><li>The form with option for file selection is displayed. The user selects the external .xls file <strong>(1-2-3)</strong>.</li></ul><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="749" width="1105" src="attachments/40044697/40044739.png" data-image-src="attachments/40044697/40044739.png" data-unresolved-comment-count="0" data-linked-resource-id="40044739" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Upload  5- correct excel file.png" data-base-url="https://ittruse.ittbg.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="40044697" data-linked-resource-container-version="10"></img></span></p><ul><li>The<strong> system checks if the specified file is in the appropriate format and styled properly</strong>:</li></ul><ol><li>The file from which codelists and code values will be uploaded <strong>must be in MS Excel format (.xls)</strong>.</li><li>The file must contain one sheet named 'Codelists' (or 'codelists' or other variations, case insensitive) which is filled in with the data to be loaded - codelists and code values.</li><li>Codelists and code values are listed in rows, parameters of codelists and code values are defined in columns.</li><li>Columns are: code, description in English, description in Bulgarian, comment in English, comment in Bulgarian, display type, order, sort by, master codelist, extra 1, extra 2, extra 3, extra4, extra5, validity start date, validity end date. Columns order is not strict which means that they can be ordered in a random way. The presence of all columns is mandatory. If some of the columns is not present error message is displayed. If there are duplicate columns error message is displayed.</li><li>Code values of one codelist are grouped using the excel group function.</li><li>The row, which defines the codelist data, is formatted with bold text. Code values are formatted with regular text. Bold text means that this row is the start of a new codelist and all rows to the next bold row are code values from the current codelist.</li><li>Other formatting (coloring, underlined, italic, etc.) does not influence the parser - the text is parsed as a plain text.</li></ol><p><strong>     Validations</strong>:</p><ol><li>&quot;Code&quot; is mandatory for codelists and code values. If not filled in system displays an error message and no data is loaded.</li><li>&quot;Code&quot; should not be duplicated within the file for codelists (the codelist identifier). If two or more codelists have the same identifier system displays an error message and no data is loaded.</li><li>&quot;Code&quot; of codelist must contain only digits. If not allowed symbol is entered system displays an error message and no data is loaded.</li><li>&quot;Code&quot; should not be duplicated within one codelist (code value codes). If two or more code values for one codelist have the same identifier system displays an error message and no data is loaded.</li><li>&quot;Code&quot; for code values to allow letters, numbers, symbols + (plus), - (minus), \ (backslash), / (slash), . (dot)</li><li>&quot;masterCL&quot; is checked. If present for a codelist, the code must be included in the file, otherwise system displays an error message and no data is loaded.</li><li>if &quot;masterCL value&quot; is present for a codelist, system should check<ol><li>whether the codelist has a &quot;master CL&quot; defined. If master CL is not defined system displays an error message and no data is loaded.</li><li>whether the master code value belongs to the master CL specified. If the code value is not from the specified as the master codelist system displays an error message and no data is loaded.</li></ol></li></ol><ul><li>When the selected file is correctly formatted it appears in the form (1) and the user clicks <strong>&quot;Upload&quot; (2)</strong> to load it in the database.</li></ul><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/40044697/40044740.png" data-image-src="attachments/40044697/40044740.png" data-unresolved-comment-count="0" data-linked-resource-id="40044740" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Upload  6- correct excel file.png" data-base-url="https://ittruse.ittbg.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="40044697" data-linked-resource-container-version="10"></img></span></p><p> </p><ul><li>When the process finishes the system displays displays message for successful operation.</li></ul><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/40044697/40044741.png" data-image-src="attachments/40044697/40044741.png" data-unresolved-comment-count="0" data-linked-resource-id="40044741" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Upload 7- correct excel file.png" data-base-url="https://ittruse.ittbg.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="40044697" data-linked-resource-container-version="10"></img></span></p><p> </p><p><strong>Note:</strong> When loading codelist data into the repository, the <strong>system clears the previous data for each codelist, that is defined in the selected file.</strong></p><p>This means that if there are already some data for codelist with identifier CL00X and in the selected file there is a given codelist with identifier CL00X, all previous code values in codelist CL00X in the repository will be deleted and only available code values will be those defined in the file.</p><p>In case such match is found, for each codelist system displays warning message and requests confirmation from the user whether the operation to be completed or canceled.</p><p><span><br /></span></p><p><span><strong>In case the file is not correctly formatted and/or is not in one of the allowed formats, system displays an error message and no data is loaded:</strong></span></p><ul><li><span><span>When the selected file</span> is of type MS Excel (.xls) but is <span>not </span>properly formatted,<span> </span> an error message with information that my file is not correctly formatted is displayed.</span></li></ul><p><span><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/40044697/40044724.png" data-image-src="attachments/40044697/40044724.png" data-unresolved-comment-count="0" data-linked-resource-id="40044724" data-linked-resource-version="2" data-linked-resource-type="attachment" data-linked-resource-default-alias="Upload  4-incorrect excel.png" data-base-url="https://ittruse.ittbg.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="40044697" data-linked-resource-container-version="10"></img></span><br /></span></p><ul><li><span>When the selected file is <span>not </span>of type MS Excel (.xls), an error message with information that my file is not in the proper type is displayed.</span></li></ul><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/40044697/40044720.png" data-image-src="attachments/40044697/40044720.png" data-unresolved-comment-count="0" data-linked-resource-id="40044720" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Upload  3-wrong format.png" data-base-url="https://ittruse.ittbg.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="40044697" data-linked-resource-container-version="10"></img></span></p><p> </p><p>There may be one or more codelists and one or more code values defined in the file.</p><p> </p>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                        </div>

                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
<section class="footer-body-sirma"></section>            </div>
        </div>     </body>
</html>
