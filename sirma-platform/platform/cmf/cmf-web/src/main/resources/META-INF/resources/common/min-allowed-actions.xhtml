<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">

	<h:panelGroup id="allowedActionsMenu" rendered="#{not renderHidden}" layout="block">
		<div>
			<div class="btn-group allowed-action-image-button #{styleClass}">
				<h:panelGroup layout="block" rendered="#{(renderLabel != null) ? renderLabel : false}">
					<button class="btn btn-default btn-xs" type="button" disabled="disabled">#{(actionTitle != null) ?
						actionTitle : label['cmf.btn.actions']}</button>
				</h:panelGroup>

				<a4j:commandLink id="actionsMenuForDashletsTrigger" value="" limitRender="true"
					action="#{actionsHolder.evaluateActionsForDashlet(dashlet)}"
					oncomplete="CMF.actionsMenu.toggleAllowedActions(#{rich:element('actionsMenuForDashletsTrigger')}, event);"
					rendered="#{dashlet != null}" render="hiddenActionsList" execute="@this"
					styleClass="btn btn-default dropdown-toggle lazy actions-menu-trigger"
					data-original-title="#{(actionTooltip != null) ? actionTooltip : label['cmf.btn.tooltip.actions']}"
					data-toggle="dropdown tooltip">
					<span class="caret"></span>
					<span class="sr-only">Toggle Dropdown</span>
				</a4j:commandLink>

				<a4j:commandLink id="actionsMenuNoContextTrigger" value="" limitRender="true"
					action="#{actionsHolder.evaluateActionsByInstanceNoContext(currentInstance, placeholder)}"
					oncomplete="CMF.actionsMenu.toggleAllowedActions(#{rich:element('actionsMenuNoContextTrigger')}, event);"
					render="hiddenActionsList" execute="@this" rendered="#{(dashlet == null) and (contextInstance == null)}"
					styleClass="btn btn-default dropdown-toggle lazy actions-menu-trigger"
					data-original-title="#{(actionTooltip != null) ? actionTooltip : label['cmf.btn.tooltip.actions']}"
					data-toggle="dropdown tooltip">
					<span class="caret"></span>
					<span class="sr-only">Toggle Dropdown</span>
				</a4j:commandLink>

				<a4j:commandLink id="actionsMenuWithContextTrigger" value="" limitRender="true"
					onclick="document.getElementsByTagName('html')[0].style.cursor='progress';this.style.cursor='progress';"
					action="#{actionsHolder.evaluateActionsByInstance(currentInstance, placeholder, ((sectionInstance != null) ? sectionInstance : contextInstance))}"
					oncomplete="CMF.actionsMenu.toggleAllowedActions(#{rich:element('actionsMenuWithContextTrigger')}, event);document.getElementsByTagName('html')[0].style.cursor='default';"
					render="hiddenActionsList" execute="@this" rendered="#{(dashlet == null) and (contextInstance != null)}"
					styleClass="btn btn-default dropdown-toggle lazy actions-menu-trigger"
					data-original-title="#{(actionTooltip != null) ? actionTooltip : label['cmf.btn.tooltip.actions']}"
					data-toggle="dropdown tooltip">
					<span class="caret"></span>
					<span class="sr-only">Toggle Dropdown</span>
				</a4j:commandLink>

				<rich:list id="hiddenActionsList" var="action" value="#{actionsHolder.instanceActions}" iterationStatusVar="items"
					styleClass="hidden-actions dropdown-menu" rowClass="clearfix">
					<ui:include src="/common/action-button-template.xhtml">
						<ui:param name="onClickAttribute" value="#{actionsManager.calculateOnclickAttribute(action)}" />
						<ui:param name="action" value="#{action}" />
						<ui:param name="renderCondition" value="#{(visibleActions != null) ? (items.index ge visibleActions) : true}" />
						<ui:param name="isImmediate" value="#{(isImmediate != null) ? isImmediate : false}" />
						<ui:param name="currentInstance" value="#{currentInstance}" />
						<ui:param name="sectionInstance" value="#{sectionInstance}" />
						<ui:param name="btnActionClass" value="#{(btnActionClass != null) ? btnActionClass : 'drop-down-actions'}" />
					</ui:include>
				</rich:list>
			</div>
		</div>
	</h:panelGroup>
</ui:composition>
