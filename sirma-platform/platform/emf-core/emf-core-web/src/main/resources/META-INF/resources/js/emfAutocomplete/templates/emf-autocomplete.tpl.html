<div>
<!-- The three NG-IFs here are used, because the <ui-select> directive can not handle the 'multiple and 'tagging' attribute like
	 multiple='false' or tagging='false', and  they can not be conditionally applied to the element (they have no 'false' value) -->
	 
	<ui-select ng-if="multiple && !tagging" multiple theme="select2" ng-model="model.selected" class="emf-autocomplete">
		<ui-select-match>{{$item.text}}</ui-select-match>
		<ui-select-choices refresh="handleChange($select.search)" refresh-delay="100" repeat="item in autocompleteData | filter:{text: $select.search}">
			<div ng-bind-html="item.text | highlight: $select.search"></div>
		</ui-select-choices>
	</ui-select>
	<ui-select ng-if="!multiple" theme="select2" ng-model="model.selected" class="emf-autocomplete">
		<ui-select-match>{{$select.selected.text}}</ui-select-match>
		<ui-select-choices refresh="handleChange($select.search)" refresh-delay="100" repeat="item in autocompleteData | filter:{text: $select.search}">
			<div ng-bind-html="item.text | highlight: $select.search"></div>
		</ui-select-choices>
	</ui-select>
	<ui-select ng-if="multiple && tagging" multiple tagging="transformTagToModel" theme="select2" ng-model="model.selected" class="emf-autocomplete">
		<ui-select-match>{{$item.text}}</ui-select-match>
		<ui-select-choices refresh="handleChange($select.search)" refresh-delay="100" repeat="item in autocompleteData | filter:{text: $select.search}">
			<div ng-bind-html="item.text | highlight: $select.search"></div>
		</ui-select-choices>
	</ui-select>
</div>