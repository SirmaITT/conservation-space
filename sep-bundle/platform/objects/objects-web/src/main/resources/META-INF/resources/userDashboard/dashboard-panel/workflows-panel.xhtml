<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:rich="http://richfaces.org/rich" xmlns:a4j="http://richfaces.org/a4j" xmlns:emf="http://com.sirma.itt.emf"
	xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html">

	<h:panelGroup id="myWorkflowsPanel" styleClass="dashboard-panel list-content my-workflows-panel col-lg-4" layout="block">
		<div class="widget-content">
		<div class="panel-header rf-p-hdr">
			<div class="panel-title">#{label['cmf.workflow.panel.header.title']}</div>

			<ui:include src="/search/dashlet-search/total-count.xhtml">
				<ui:param name="panelId" value="myWorkflowsPanel" />
				<ui:param name="action" value="#{myWorkflowsPanel}" />
			</ui:include>

			<ui:include src="/dashlet/dashlet-controls.xhtml">
				<ui:param name="panelId" value="myWorkflowsPanel" />
				<ui:param name="action" value="#{myWorkflowsPanel}" />
			</ui:include>
		</div>

		<h:panelGroup id="myWorkflowsPanelToolbar" styleClass="panel-toolbar" layout="block">
			<ui:include src="/search/dashlet-search/search-toolbar.xhtml">
				<ui:param name="panelId" value="myWorkflowsPanel" />
				<ui:param name="action" value="#{myWorkflowsPanel}" />
				<ui:param name="renderId" value="myWorkflowsPanel" />
			</ui:include>
		</h:panelGroup>

		<div class="panel-body my-workflows-panel-body clearfix">
			<rich:list id="dashletWorkflowList" value="#{myWorkflowsPanel.result}" var="workflow" type="unordered"
				styleClass="workflow-history-list" rowClass="list-item">

				<emf:treeHeader currentInstance="#{workflow}" mode="#{dashletsTreeHeaderMode}" display="current_only"
					size="#{dashletsTreeHeaderSize}" />

				<div class="item-link-min">
					<ui:include src="/common/min-allowed-actions.xhtml">
						<ui:param name="currentInstance" value="#{workflow}" />
						<ui:param name="contextInstance" value="#{documentContext.getCurrentInstance()}" />
						<ui:param name="placeholder" value="#{myWorkflowsPanel.targetDashletName()}" />
						<ui:param name="ajaxLoaderRenderElement" value=".my-workflows-panel-body" />
					</ui:include>
				</div>

				<ui:include src="/workflow/includes/workflow-cancel-popup.xhtml">
					<ui:param name="currentInstanceObject" value="#{workflow}" />
				</ui:include>
			</rich:list>
		</div>

		<a4j:commandLink id="refreshMyWorkflowsDashlet" value="refreshMyWorkflowsDashlet" action="refreshMyWorkflowsDashlet"
			onclick="EMF.ajaxloader.showLoading('.my-workflows-panel-body');"
			oncomplete="EMF.ajaxloader.hideLoading('.my-workflows-panel-body');" styleClass="load-my-workflows-link hide"
			render="dashletWorkflowList, myWorkflowsPanelToolbar" execute="@this" />
		</div>
	</h:panelGroup>

</ui:composition>
